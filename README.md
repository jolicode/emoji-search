# Emoji synonyms and analyzer for Elasticsearch
> Add support for emoji in any Solr compatible search engine!

## What is this

This repository host synonym files in Solr format, based on [CLDR data set](http://cldr.unicode.org/).

Learn more about this in our [blog post](TODO).

Current version is based on 29Î².

## Installation in Elasticsearch

### Elasticsearch mapping with emoji support

Download the emoji file you want and store it in `PATH_ES/config/analysis`.

Then create an analyzer (called `english_with_emoji` here):

```json
PUT /en-emoji
{
  "settings": {
    "analysis": {
      "filter": {
        "english_emoji": {
          "type": "synonym",
          "synonyms_path": "analysis/cldr-emoji-annotation-synonyms-en.txt" 
        }
      },
      "analyzer": {
        "english_with_emoji": {
          "tokenizer": "whitespace",
          "filter": [
            "lowercase",
            "english_emoji"
          ]
        }
      }
    }
  }
}
```

Trying it:

```json
GET /en-emoji/_analyze?analyzer=english_with_emoji
{
  "text": "I love ðŸ©!"
}

{
  "tokens": [
    {
      "token": "i",
      "start_offset": 0,
      "end_offset": 1,
      "type": "word",
      "position": 0
    },
    {
      "token": "love",
      "start_offset": 2,
      "end_offset": 6,
      "type": "word",
      "position": 1
    },
    {
      "token": "ðŸ©!",
      "start_offset": 7,
      "end_offset": 10,
      "type": "word",
      "position": 2
    }
  ]
}
```

### Add Emoticon support

To support Emoticon, you can add this `char_filter`:

```json
PUT /en-emoji
{
  "settings": {
    "analysis": {
      "char_filter": {
        "emoticons_char_filter": {
          "type": "mapping",
          "mappings": [">:(=>ðŸ˜ ",">:[=>ðŸ˜ ",">:-(=>ðŸ˜ ",">:-[=>ðŸ˜ ",">=(=>ðŸ˜ ",">=[=>ðŸ˜ ",">=-(=>ðŸ˜ ",">=-[=>ðŸ˜ ",":\")=>ðŸ˜Š",":\"]=>ðŸ˜Š",":\"D=>ðŸ˜Š",":-\")=>ðŸ˜Š",":-\"]=>ðŸ˜Š",":-\"D=>ðŸ˜Š","=\")=>ðŸ˜Š","=\"]=>ðŸ˜Š","=\"D=>ðŸ˜Š","=-\")=>ðŸ˜Š","=-\"]=>ðŸ˜Š","=-\"D=>ðŸ˜Š","<\\\\3=>ðŸ’”","<\/3=>ðŸ’”",":\/=>ðŸ˜•",":\\\\=>ðŸ˜•",":-\/=>ðŸ˜•",":-\\\\=>ðŸ˜•","=\/=>ðŸ˜•","=\\\\=>ðŸ˜•","=-\/=>ðŸ˜•","=-\\\\=>ðŸ˜•",":,(=>ðŸ˜¢",":,[=>ðŸ˜¢",":,|=>ðŸ˜¢",":,-(=>ðŸ˜¢",":,-[=>ðŸ˜¢",":,-|=>ðŸ˜¢",":'(=>ðŸ˜¢",":'[=>ðŸ˜¢",":'|=>ðŸ˜¢",":'-(=>ðŸ˜¢",":'-[=>ðŸ˜¢",":'-|=>ðŸ˜¢","=,(=>ðŸ˜¢","=,[=>ðŸ˜¢","=,|=>ðŸ˜¢","=,-(=>ðŸ˜¢","=,-[=>ðŸ˜¢","=,-|=>ðŸ˜¢","='(=>ðŸ˜¢","='[=>ðŸ˜¢","='|=>ðŸ˜¢","='-(=>ðŸ˜¢","='-[=>ðŸ˜¢","='-|=>ðŸ˜¢",":(=>ðŸ˜¦",":[=>ðŸ˜¦",":-(=>ðŸ˜¦",":-[=>ðŸ˜¦","=(=>ðŸ˜¦","=[=>ðŸ˜¦","=-(=>ðŸ˜¦","=-[=>ðŸ˜¦","<3=>â¤ï¸","]:(=>ðŸ‘¿","]:[=>ðŸ‘¿","]:-(=>ðŸ‘¿","]:-[=>ðŸ‘¿","]=(=>ðŸ‘¿","]=[=>ðŸ‘¿","]=-(=>ðŸ‘¿","]=-[=>ðŸ‘¿","o:)=>ðŸ˜‡","o:]=>ðŸ˜‡","o:D=>ðŸ˜‡","o:-)=>ðŸ˜‡","o:-]=>ðŸ˜‡","o:-D=>ðŸ˜‡","o=)=>ðŸ˜‡","o=]=>ðŸ˜‡","o=D=>ðŸ˜‡","o=-)=>ðŸ˜‡","o=-]=>ðŸ˜‡","o=-D=>ðŸ˜‡","O:)=>ðŸ˜‡","O:]=>ðŸ˜‡","O:D=>ðŸ˜‡","O:-)=>ðŸ˜‡","O:-]=>ðŸ˜‡","O:-D=>ðŸ˜‡","O=)=>ðŸ˜‡","O=]=>ðŸ˜‡","O=D=>ðŸ˜‡","O=-)=>ðŸ˜‡","O=-]=>ðŸ˜‡","O=-D=>ðŸ˜‡","0:)=>ðŸ˜‡","0:]=>ðŸ˜‡","0:D=>ðŸ˜‡","0:-)=>ðŸ˜‡","0:-]=>ðŸ˜‡","0:-D=>ðŸ˜‡","0=)=>ðŸ˜‡","0=]=>ðŸ˜‡","0=D=>ðŸ˜‡","0=-)=>ðŸ˜‡","0=-]=>ðŸ˜‡","0=-D=>ðŸ˜‡",":,)=>ðŸ˜‚",":,]=>ðŸ˜‚",":,D=>ðŸ˜‚",":,-)=>ðŸ˜‚",":,-]=>ðŸ˜‚",":,-D=>ðŸ˜‚",":')=>ðŸ˜‚",":']=>ðŸ˜‚",":'D=>ðŸ˜‚",":'-)=>ðŸ˜‚",":'-]=>ðŸ˜‚",":'-D=>ðŸ˜‚","=,)=>ðŸ˜‚","=,]=>ðŸ˜‚","=,D=>ðŸ˜‚","=,-)=>ðŸ˜‚","=,-]=>ðŸ˜‚","=,-D=>ðŸ˜‚","=')=>ðŸ˜‚","=']=>ðŸ˜‚","='D=>ðŸ˜‚","='-)=>ðŸ˜‚","='-]=>ðŸ˜‚","='-D=>ðŸ˜‚",":*=>ðŸ˜—",":-*=>ðŸ˜—","=*=>ðŸ˜—","=-*=>ðŸ˜—","x)=>ðŸ˜†","x]=>ðŸ˜†","xD=>ðŸ˜†","x-)=>ðŸ˜†","x-]=>ðŸ˜†","x-D=>ðŸ˜†","X)=>ðŸ˜†","X]=>ðŸ˜†","X-)=>ðŸ˜†","X-]=>ðŸ˜†","X-D=>ðŸ˜†",":3=>ðŸ‘¨",":-3=>ðŸ‘¨","=3=>ðŸ‘¨","=-3=>ðŸ‘¨",";3=>ðŸ‘¨",";-3=>ðŸ‘¨","x3=>ðŸ‘¨","x-3=>ðŸ‘¨","X3=>ðŸ‘¨","X-3=>ðŸ‘¨",":|=>ðŸ˜",":-|=>ðŸ˜","=|=>ðŸ˜","=-|=>ðŸ˜",":-=>ðŸ˜¶",":o=>ðŸ˜®",":O=>ðŸ˜®",":0=>ðŸ˜®",":-o=>ðŸ˜®",":-O=>ðŸ˜®",":-0=>ðŸ˜®","=o=>ðŸ˜®","=O=>ðŸ˜®","=0=>ðŸ˜®","=-o=>ðŸ˜®","=-O=>ðŸ˜®","=-0=>ðŸ˜®",":@=>ðŸ˜¡",":-@=>ðŸ˜¡","=@=>ðŸ˜¡","=-@=>ðŸ˜¡",":D=>ðŸ˜„",":-D=>ðŸ˜„","=D=>ðŸ˜„","=-D=>ðŸ˜„",":)=>ðŸ˜ƒ",":]=>ðŸ˜ƒ",":-)=>ðŸ˜ƒ",":-]=>ðŸ˜ƒ","=)=>ðŸ˜ƒ","=]=>ðŸ˜ƒ","=-)=>ðŸ˜ƒ","=-]=>ðŸ˜ƒ","]:)=>ðŸ˜ˆ","]:]=>ðŸ˜ˆ","]:D=>ðŸ˜ˆ","]:-)=>ðŸ˜ˆ","]:-]=>ðŸ˜ˆ","]:-D=>ðŸ˜ˆ","]=)=>ðŸ˜ˆ","]=]=>ðŸ˜ˆ","]=D=>ðŸ˜ˆ","]=-)=>ðŸ˜ˆ","]=-]=>ðŸ˜ˆ","]=-D=>ðŸ˜ˆ",":,'(=>ðŸ˜­",":,'[=>ðŸ˜­",":,'-(=>ðŸ˜­",":,'-[=>ðŸ˜­",":',(=>ðŸ˜­",":',[=>ðŸ˜­",":',-(=>ðŸ˜­",":',-[=>ðŸ˜­","=,'(=>ðŸ˜­","=,'[=>ðŸ˜­","=,'-(=>ðŸ˜­","=,'-[=>ðŸ˜­","=',(=>ðŸ˜­","=',[=>ðŸ˜­","=',-(=>ðŸ˜­","=',-[=>ðŸ˜­",":p=>ðŸ˜›",":P=>ðŸ˜›",":d=>ðŸ˜›",":-p=>ðŸ˜›",":-P=>ðŸ˜›",":-d=>ðŸ˜›","=p=>ðŸ˜›","=P=>ðŸ˜›","=d=>ðŸ˜›","=-p=>ðŸ˜›","=-P=>ðŸ˜›","=-d=>ðŸ˜›","xP=>ðŸ˜","x-p=>ðŸ˜","x-P=>ðŸ˜","x-d=>ðŸ˜","Xp=>ðŸ˜","Xd=>ðŸ˜","X-p=>ðŸ˜","X-P=>ðŸ˜","X-d=>ðŸ˜",";p=>ðŸ˜œ",";P=>ðŸ˜œ",";d=>ðŸ˜œ",";-p=>ðŸ˜œ",";-P=>ðŸ˜œ",";-d=>ðŸ˜œ","8)=>ðŸ˜Ž","8]=>ðŸ˜Ž","8D=>ðŸ˜Ž","8-)=>ðŸ˜Ž","8-]=>ðŸ˜Ž","8-D=>ðŸ˜Ž","B)=>ðŸ˜Ž","B]=>ðŸ˜Ž","B-)=>ðŸ˜Ž","B-]=>ðŸ˜Ž","B-D=>ðŸ˜Ž",",:(=>ðŸ˜“",",:[=>ðŸ˜“",",:-(=>ðŸ˜“",",:-[=>ðŸ˜“",",=(=>ðŸ˜“",",=[=>ðŸ˜“",",=-(=>ðŸ˜“",",=-[=>ðŸ˜“","':(=>ðŸ˜“","':[=>ðŸ˜“","':-(=>ðŸ˜“","':-[=>ðŸ˜“","'=(=>ðŸ˜“","'=[=>ðŸ˜“","'=-(=>ðŸ˜“","'=-[=>ðŸ˜“",",:)=>ðŸ˜…",",:]=>ðŸ˜…",",:D=>ðŸ˜…",",:-)=>ðŸ˜…",",:-]=>ðŸ˜…",",:-D=>ðŸ˜…",",=)=>ðŸ˜…",",=]=>ðŸ˜…",",=D=>ðŸ˜…",",=-)=>ðŸ˜…",",=-]=>ðŸ˜…",",=-D=>ðŸ˜…","':)=>ðŸ˜…","':]=>ðŸ˜…","':D=>ðŸ˜…","':-)=>ðŸ˜…","':-]=>ðŸ˜…","':-D=>ðŸ˜…","'=)=>ðŸ˜…","'=]=>ðŸ˜…","'=D=>ðŸ˜…","'=-)=>ðŸ˜…","'=-]=>ðŸ˜…","'=-D=>ðŸ˜…",":$=>ðŸ˜’",":s=>ðŸ˜’",":z=>ðŸ˜’",":S=>ðŸ˜’",":Z=>ðŸ˜’",":-$=>ðŸ˜’",":-s=>ðŸ˜’",":-z=>ðŸ˜’",":-S=>ðŸ˜’",":-Z=>ðŸ˜’","=$=>ðŸ˜’","=s=>ðŸ˜’","=z=>ðŸ˜’","=S=>ðŸ˜’","=Z=>ðŸ˜’","=-$=>ðŸ˜’","=-s=>ðŸ˜’","=-z=>ðŸ˜’","=-S=>ðŸ˜’","=-Z=>ðŸ˜’",";)=>ðŸ˜‰",";]=>ðŸ˜‰",";D=>ðŸ˜‰",";-)=>ðŸ˜‰",";-]=>ðŸ˜‰",";-D=>ðŸ˜‰"]
        }
      },
      "filter": {
        "english_emoji": {
          "type": "synonym",
          "synonyms_path": "analysis/cldr-emoji-annotation-synonyms-en.txt" 
        }
      },
      "analyzer": {
        "english_with_emoji": {
          "char_filter": "emoticons_char_filter",
          "tokenizer": "whitespace",
          "filter": [
            "lowercase",
            "english_emoji"
          ]
        }
      }
    }
  }
}
```

```
GET /en-emoji/_analyze?analyzer=english_with_emoji
{
  "text": "I <\\3  ðŸ©"
}

{
  "tokens": [
    {
      "token": "i",
      "start_offset": 0,
      "end_offset": 1,
      "type": "word",
      "position": 0
    },
    {
      "token": "ðŸ’”",
      "start_offset": 2,
      "end_offset": 5,
      "type": "SYNONYM",
      "position": 1
    },
    {
      "token": "break",
      "start_offset": 2,
      "end_offset": 5,
      "type": "SYNONYM",
      "position": 1
    },
    {
      "token": "broken",
      "start_offset": 2,
      "end_offset": 5,
      "type": "SYNONYM",
      "position": 1
    },
    {
      "token": "heart",
      "start_offset": 2,
      "end_offset": 5,
      "type": "SYNONYM",
      "position": 1
    },
    {
      "token": "ðŸ©",
      "start_offset": 7,
      "end_offset": 9,
      "type": "SYNONYM",
      "position": 2
    },
    {
      "token": "dessert",
      "start_offset": 7,
      "end_offset": 9,
      "type": "SYNONYM",
      "position": 2
    },
    {
      "token": "donut",
      "start_offset": 7,
      "end_offset": 9,
      "type": "SYNONYM",
      "position": 2
    },
    {
      "token": "sweet",
      "start_offset": 7,
      "end_offset": 9,
      "type": "SYNONYM",
      "position": 2
    }
  ]
}
```

## How to contribute

## Credits

## License